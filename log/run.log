============================================================
[run.sh] Legal Text Decoder - Full Pipeline
[run.sh] Starting at 2025-12-09T01:21:43+01:00
============================================================

[run.sh] Step 1: Data Preprocessing
------------------------------------------------------------
2025-12-09 01:21:43,807 - INFO - ============================================================
2025-12-09 01:21:43,807 - INFO - Starting data preprocessing...
2025-12-09 01:21:43,807 - INFO - ============================================================
2025-12-09 01:21:43,807 - INFO -
Loading data from data
2025-12-09 01:21:43,808 - INFO - Found 37 JSON files in data
2025-12-09 01:21:43,809 - INFO - Loaded 120 samples from WFXBHI/libri_aszf.json
2025-12-09 01:21:43,810 - INFO - Loaded 66 samples from WFXBHI/kepregeny_depo_aszf.json
2025-12-09 01:21:43,811 - INFO - Loaded 89 samples from LWVUH9/shiver_aszf_cimkezes.json
2025-12-09 01:21:43,811 - INFO - Loaded 69 samples from LWVUH9/sportkorhaz_aszf_cimkezes.json
2025-12-09 01:21:43,814 - INFO - Loaded 269 samples from EKGPBX/project-29-at-2025-10-16-16-34-dc747442.json
2025-12-09 01:21:43,815 - INFO - Loaded 143 samples from MDKFWC/hasznalt_auto_cimkek.json
2025-12-09 01:21:43,816 - INFO - Loaded 103 samples from G1QFG2/cimkezes.json
2025-12-09 01:21:43,817 - INFO - Loaded 133 samples from LXXAMS/budapestgo_aszf.json
2025-12-09 01:21:43,818 - INFO - Loaded 120 samples from Z7ZF6D/vatera-aszf.json
2025-12-09 01:21:43,819 - INFO - Loaded 107 samples from BCLHKC/cimkezes.json
2025-12-09 01:21:43,820 - INFO - Loaded 101 samples from GSFSJ1/fonallak_cimkezes.json
2025-12-09 01:21:43,821 - INFO - Loaded 144 samples from T989VT/legal_text_dataset.json
2025-12-09 01:21:43,823 - INFO - Loaded 224 samples from Q88P3E/erste-diakhitel-kozpont_cimkezes.json
2025-12-09 01:21:43,824 - INFO - Loaded 151 samples from F0B9YK/holyduck_aszf.json
2025-12-09 01:21:43,825 - INFO - Loaded 92 samples from K3I7DL/KH_aszf_cimkezes.json
2025-12-09 01:21:43,826 - INFO - Loaded 105 samples from E77YIW/mak_aszf_cimkezes.json
2025-12-09 01:21:43,827 - INFO - Loaded 119 samples from QG1L1V/granit_bank_cimkezes.json
2025-12-09 01:21:43,828 - INFO - Loaded 111 samples from XQEBMQ/xqebmq.json
2025-12-09 01:21:43,829 - INFO - Loaded 123 samples from HW921K/labeled_terms.json
2025-12-09 01:21:43,830 - INFO - Loaded 124 samples from HV75KB/labels.json
2025-12-09 01:21:43,831 - INFO - Loaded 189 samples from SS0N7G/alza_aszf.json
2025-12-09 01:21:43,833 - INFO - Loaded 126 samples from TFH22P/cimekezes.json
2025-12-09 01:21:43,833 - INFO - Loaded 68 samples from A5VHUA/nemzeti_tehetseg_program_aszf_labeled.json
2025-12-09 01:21:43,834 - INFO - Loaded 91 samples from A5VHUA/belvarosi_epito_aszf_labeled.json
2025-12-09 01:21:43,836 - INFO - Loaded 159 samples from A5VHUA/merged_annotations.json
2025-12-09 01:21:43,837 - INFO - Loaded 110 samples from R1Q6I8/telekom_aszf.json
2025-12-09 01:21:43,850 - INFO - Loaded 15 samples from NHVU6N/netkazan_labeled.json
2025-12-09 01:21:43,850 - INFO - Loaded 50 samples from NHVU6N/zalando_labeled.json
2025-12-09 01:21:43,851 - INFO - Loaded 40 samples from NHVU6N/hardverapro_labeled.json
2025-12-09 01:21:43,851 - INFO - Loaded 110 samples from I1TLYH/dpd.json
2025-12-09 01:21:43,853 - INFO - Loaded 168 samples from I1TLYH/epitesi_beruhazas.json
2025-12-09 01:21:43,854 - INFO - Loaded 104 samples from FA0B9B/FA0B9B_labeling.json
2025-12-09 01:21:43,854 - INFO - Total samples loaded: 3743
2025-12-09 01:21:43,854 - INFO -
Removing duplicates...
2025-12-09 01:21:43,857 - INFO - Removed 346 duplicate samples
2025-12-09 01:21:43,857 - INFO -
==================================================
2025-12-09 01:21:43,857 - INFO - Full Dataset Statistics:
2025-12-09 01:21:43,857 - INFO - ==================================================
2025-12-09 01:21:43,857 - INFO - Total samples: 3397
2025-12-09 01:21:43,857 - INFO -
Label distribution:
2025-12-09 01:21:43,857 - INFO -   Label 1:   176 (  5.2%)
2025-12-09 01:21:43,857 - INFO -   Label 2:   392 ( 11.5%)
2025-12-09 01:21:43,857 - INFO -   Label 3:   721 ( 21.2%)
2025-12-09 01:21:43,857 - INFO -   Label 4:  1022 ( 30.1%)
2025-12-09 01:21:43,857 - INFO -   Label 5:  1086 ( 32.0%)
2025-12-09 01:21:43,858 - INFO -
Text length (chars):
2025-12-09 01:21:43,858 - INFO -   Min: 2
2025-12-09 01:21:43,858 - INFO -   Max: 9223
2025-12-09 01:21:43,858 - INFO -   Mean: 405.4
2025-12-09 01:21:43,858 - INFO -
Data from 25 source folders
2025-12-09 01:21:43,858 - INFO - ==================================================

2025-12-09 01:21:43,858 - INFO - Splitting data into train/val/test sets...
2025-12-09 01:21:43,859 - INFO -
==================================================
2025-12-09 01:21:43,859 - INFO - Training Set Statistics:
2025-12-09 01:21:43,859 - INFO - ==================================================
2025-12-09 01:21:43,859 - INFO - Total samples: 2714
2025-12-09 01:21:43,859 - INFO -
Label distribution:
2025-12-09 01:21:43,859 - INFO -   Label 1:   140 (  5.2%)
2025-12-09 01:21:43,859 - INFO -   Label 2:   313 ( 11.5%)
2025-12-09 01:21:43,859 - INFO -   Label 3:   576 ( 21.2%)
2025-12-09 01:21:43,859 - INFO -   Label 4:   817 ( 30.1%)
2025-12-09 01:21:43,859 - INFO -   Label 5:   868 ( 32.0%)
2025-12-09 01:21:43,860 - INFO -
Text length (chars):
2025-12-09 01:21:43,860 - INFO -   Min: 2
2025-12-09 01:21:43,860 - INFO -   Max: 9223
2025-12-09 01:21:43,860 - INFO -   Mean: 411.6
2025-12-09 01:21:43,860 - INFO -
Data from 25 source folders
2025-12-09 01:21:43,860 - INFO - ==================================================

2025-12-09 01:21:43,860 - INFO -
==================================================
2025-12-09 01:21:43,860 - INFO - Validation Set Statistics:
2025-12-09 01:21:43,860 - INFO - ==================================================
2025-12-09 01:21:43,860 - INFO - Total samples: 338
2025-12-09 01:21:43,860 - INFO -
Label distribution:
2025-12-09 01:21:43,860 - INFO -   Label 1:    17 (  5.0%)
2025-12-09 01:21:43,860 - INFO -   Label 2:    39 ( 11.5%)
2025-12-09 01:21:43,860 - INFO -   Label 3:    72 ( 21.3%)
2025-12-09 01:21:43,860 - INFO -   Label 4:   102 ( 30.2%)
2025-12-09 01:21:43,860 - INFO -   Label 5:   108 ( 32.0%)
2025-12-09 01:21:43,860 - INFO -
Text length (chars):
2025-12-09 01:21:43,860 - INFO -   Min: 17
2025-12-09 01:21:43,860 - INFO -   Max: 7362
2025-12-09 01:21:43,860 - INFO -   Mean: 402.9
2025-12-09 01:21:43,860 - INFO -
Data from 25 source folders
2025-12-09 01:21:43,860 - INFO - ==================================================

2025-12-09 01:21:43,860 - INFO -
==================================================
2025-12-09 01:21:43,860 - INFO - Test Set Statistics:
2025-12-09 01:21:43,860 - INFO - ==================================================
2025-12-09 01:21:43,860 - INFO - Total samples: 345
2025-12-09 01:21:43,860 - INFO -
Label distribution:
2025-12-09 01:21:43,860 - INFO -   Label 1:    19 (  5.5%)
2025-12-09 01:21:43,860 - INFO -   Label 2:    40 ( 11.6%)
2025-12-09 01:21:43,860 - INFO -   Label 3:    73 ( 21.2%)
2025-12-09 01:21:43,860 - INFO -   Label 4:   103 ( 29.9%)
2025-12-09 01:21:43,860 - INFO -   Label 5:   110 ( 31.9%)
2025-12-09 01:21:43,860 - INFO -
Text length (chars):
2025-12-09 01:21:43,860 - INFO -   Min: 2
2025-12-09 01:21:43,860 - INFO -   Max: 3620
2025-12-09 01:21:43,860 - INFO -   Mean: 359.4
2025-12-09 01:21:43,860 - INFO -
Data from 25 source folders
2025-12-09 01:21:43,860 - INFO - ==================================================

2025-12-09 01:21:43,877 - INFO - Saved 3397 samples to data/processed/all_data.json
2025-12-09 01:21:43,890 - INFO - Saved 2714 samples to data/processed/train.json
2025-12-09 01:21:43,891 - INFO - Saved 338 samples to data/processed/val.json
2025-12-09 01:21:43,893 - INFO - Saved 345 samples to data/processed/test.json
2025-12-09 01:21:43,893 - INFO - ============================================================
2025-12-09 01:21:43,893 - INFO - Data preprocessing complete!
2025-12-09 01:21:43,893 - INFO - ============================================================

[run.sh] Step 2: Baseline Model
------------------------------------------------------------
2025-12-09 01:21:44,312 - INFO - ============================================================
2025-12-09 01:21:44,312 - INFO - Training Baseline Models
2025-12-09 01:21:44,312 - INFO - ============================================================
2025-12-09 01:21:44,312 - INFO -
Loading data...
2025-12-09 01:21:44,318 - INFO - Train size: 2714
2025-12-09 01:21:44,318 - INFO - Val size:   338
2025-12-09 01:21:44,318 - INFO - Test size:  345
2025-12-09 01:21:44,318 - INFO -
Creating TF-IDF features...
2025-12-09 01:21:44,470 - INFO - TF-IDF features: 10000
2025-12-09 01:21:44,470 - INFO -
--------------------------------------------------
2025-12-09 01:21:44,470 - INFO - Training Logistic Regression...
/nix/store/l0w12xdqxzjna8qgldqhbckhlrn9ad3d-python3.12-scikit-learn-1.7.1/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1272: FutureWarning: 'multi_class' was deprecated in version 1.5 and will be removed in 1.7. From then on, it will always use 'multinomial'. Leave it to its default value to avoid this warning.
  warnings.warn(
2025-12-09 01:21:44,578 - INFO -
--- Logistic Regression (Validation) ---
2025-12-09 01:21:44,580 - INFO -
==================================================
2025-12-09 01:21:44,580 - INFO - LR Validation Evaluation Results
2025-12-09 01:21:44,580 - INFO - ==================================================
2025-12-09 01:21:44,580 - INFO - Accuracy:     0.3550
2025-12-09 01:21:44,580 - INFO - Macro F1:     0.2991
2025-12-09 01:21:44,580 - INFO - MAE:          0.9615
2025-12-09 01:21:44,580 - INFO - Cohen's Kappa (quadratic): 0.3763
2025-12-09 01:21:44,580 - INFO -
Classification Report:
2025-12-09 01:21:44,582 - INFO -
              precision    recall  f1-score   support

           1       0.18      0.18      0.18        17
           2       0.20      0.23      0.22        39
           3       0.24      0.25      0.24        72
           4       0.36      0.30      0.33       102
           5       0.51      0.55      0.53       108

    accuracy                           0.36       338
   macro avg       0.30      0.30      0.30       338
weighted avg       0.36      0.36      0.35       338

2025-12-09 01:21:44,582 - INFO -
Confusion Matrix:
2025-12-09 01:21:44,583 - INFO -
[[ 3  5  3  2  4]
 [ 3  9 14  6  7]
 [ 8 12 18 19 15]
 [ 3 14 24 31 30]
 [ 0  4 17 28 59]]
2025-12-09 01:21:44,583 - INFO -
--- Logistic Regression (Test) ---
2025-12-09 01:21:44,584 - INFO -
==================================================
2025-12-09 01:21:44,584 - INFO - LR Test Evaluation Results
2025-12-09 01:21:44,584 - INFO - ==================================================
2025-12-09 01:21:44,584 - INFO - Accuracy:     0.3623
2025-12-09 01:21:44,584 - INFO - Macro F1:     0.2954
2025-12-09 01:21:44,584 - INFO - MAE:          0.9681
2025-12-09 01:21:44,584 - INFO - Cohen's Kappa (quadratic): 0.3325
2025-12-09 01:21:44,584 - INFO -
Classification Report:
2025-12-09 01:21:44,587 - INFO -
              precision    recall  f1-score   support

           1       0.23      0.16      0.19        19
           2       0.19      0.20      0.19        40
           3       0.19      0.18      0.18        73
           4       0.38      0.34      0.36       103
           5       0.52      0.60      0.55       110

    accuracy                           0.36       345
   macro avg       0.30      0.30      0.30       345
weighted avg       0.35      0.36      0.36       345

2025-12-09 01:21:44,587 - INFO -
Confusion Matrix:
2025-12-09 01:21:44,587 - INFO -
[[ 3  7  4  0  5]
 [ 1  8 17  8  6]
 [ 3 10 13 25 22]
 [ 2 13 24 35 29]
 [ 4  5 11 24 66]]
2025-12-09 01:21:44,587 - INFO -
--------------------------------------------------
2025-12-09 01:21:44,587 - INFO - Training Linear SVM...
2025-12-09 01:21:44,614 - INFO -
--- Linear SVM (Validation) ---
2025-12-09 01:21:44,616 - INFO -
==================================================
2025-12-09 01:21:44,616 - INFO - SVM Validation Evaluation Results
2025-12-09 01:21:44,616 - INFO - ==================================================
2025-12-09 01:21:44,616 - INFO - Accuracy:     0.3225
2025-12-09 01:21:44,616 - INFO - Macro F1:     0.2732
2025-12-09 01:21:44,616 - INFO - MAE:          1.0148
2025-12-09 01:21:44,616 - INFO - Cohen's Kappa (quadratic): 0.3166
2025-12-09 01:21:44,616 - INFO -
Classification Report:
2025-12-09 01:21:44,618 - INFO -
              precision    recall  f1-score   support

           1       0.20      0.18      0.19        17
           2       0.19      0.21      0.20        39
           3       0.23      0.18      0.20        72
           4       0.31      0.33      0.32       102
           5       0.45      0.47      0.46       108

    accuracy                           0.32       338
   macro avg       0.27      0.27      0.27       338
weighted avg       0.32      0.32      0.32       338

2025-12-09 01:21:44,618 - INFO -
Confusion Matrix:
2025-12-09 01:21:44,618 - INFO -
[[ 3  4  4  3  3]
 [ 2  8 10 11  8]
 [ 7 12 13 24 16]
 [ 2 13 17 34 36]
 [ 1  6 13 37 51]]
2025-12-09 01:21:44,618 - INFO -
--- Linear SVM (Test) ---
2025-12-09 01:21:44,619 - INFO -
==================================================
2025-12-09 01:21:44,619 - INFO - SVM Test Evaluation Results
2025-12-09 01:21:44,619 - INFO - ==================================================
2025-12-09 01:21:44,619 - INFO - Accuracy:     0.3594
2025-12-09 01:21:44,620 - INFO - Macro F1:     0.3008
2025-12-09 01:21:44,620 - INFO - MAE:          0.9768
2025-12-09 01:21:44,620 - INFO - Cohen's Kappa (quadratic): 0.3190
2025-12-09 01:21:44,620 - INFO -
Classification Report:
2025-12-09 01:21:44,622 - INFO -
              precision    recall  f1-score   support

           1       0.29      0.21      0.24        19
           2       0.17      0.15      0.16        40
           3       0.23      0.21      0.22        73
           4       0.36      0.38      0.37       103
           5       0.48      0.55      0.51       110

    accuracy                           0.36       345
   macro avg       0.31      0.30      0.30       345
weighted avg       0.35      0.36      0.35       345

2025-12-09 01:21:44,622 - INFO -
Confusion Matrix:
2025-12-09 01:21:44,622 - INFO -
[[ 4  7  5  1  2]
 [ 0  6 14 12  8]
 [ 3  7 15 25 23]
 [ 3 10 20 39 31]
 [ 4  5 11 30 60]]
2025-12-09 01:21:44,622 - INFO -
============================================================
2025-12-09 01:21:44,622 - INFO - BASELINE SUMMARY
2025-12-09 01:21:44,622 - INFO - ============================================================
2025-12-09 01:21:44,622 - INFO -
Validation Results:
2025-12-09 01:21:44,622 - INFO -   Logistic Regression: Acc=0.3550, F1=0.2991, MAE=0.9615
2025-12-09 01:21:44,622 - INFO -   Linear SVM:          Acc=0.3225, F1=0.2732, MAE=1.0148
2025-12-09 01:21:44,622 - INFO -
Test Results:
2025-12-09 01:21:44,622 - INFO -   Logistic Regression: Acc=0.3623, F1=0.2954, MAE=0.9681
2025-12-09 01:21:44,622 - INFO -   Linear SVM:          Acc=0.3594, F1=0.3008, MAE=0.9768
2025-12-09 01:21:44,622 - INFO -
Best baseline model: Logistic Regression
2025-12-09 01:21:44,679 - INFO - Saved baseline model to models
2025-12-09 01:21:44,679 - INFO - ============================================================
2025-12-09 01:21:44,679 - INFO - Baseline training complete!
2025-12-09 01:21:44,679 - INFO - ============================================================

[run.sh] Step 3: Training Deep Learning Model
------------------------------------------------------------
2025-12-09 01:21:46,485 - INFO - ============================================================
2025-12-09 01:21:46,485 - INFO - Starting Training
2025-12-09 01:21:46,485 - INFO - ============================================================
2025-12-09 01:21:46,594 - INFO - Using device: cuda
2025-12-09 01:21:46,596 - INFO - GPU: NVIDIA GeForce RTX 5090
2025-12-09 01:21:46,596 - INFO - GPU Memory: 33.67 GB
2025-12-09 01:21:46,596 - INFO -
Loading data...
2025-12-09 01:21:47,049 - INFO - Train size: 2714
2025-12-09 01:21:47,049 - INFO - Val size: 338
2025-12-09 01:21:47,049 - INFO - Test size: 345
2025-12-09 01:21:47,934 - INFO - Class weights: [3.877142906188965, 1.7341853380203247, 0.9423611164093018, 0.6643818616867065, 0.6253456473350525]
2025-12-09 01:21:47,934 - INFO -
Initializing model...
2025-12-09 01:21:47,934 - INFO - Dropout: 0.3
2025-12-09 01:21:47,934 - INFO - Frozen encoder layers: 4
2025-12-09 01:21:47,934 - INFO - Weight decay: 0.05
2025-12-09 01:21:48,261 - INFO - Model parameters: 110,621,957
2025-12-09 01:21:48,261 - INFO - Trainable parameters: 57,297,413
2025-12-09 01:21:48,262 - INFO - Using Progressive Weighted Ordinal Loss (0.2 -> 0.8)
2025-12-09 01:21:48,262 - INFO - Total training steps: 6800
2025-12-09 01:21:48,262 - INFO - Warmup steps: 680
2025-12-09 01:21:48,262 - INFO -
Starting training loop...
2025-12-09 01:21:48,262 - INFO -
==================================================
2025-12-09 01:21:48,262 - INFO - Epoch 1/20
2025-12-09 01:21:48,262 - INFO - ==================================================
2025-12-09 01:21:48,262 - INFO - Ordinal weight: 0.20
Training: 100%|██████████| 340/340 [00:17<00:00, 18.99it/s, loss=2.85]
2025-12-09 01:22:06,166 - INFO - Train - Loss: 1.5521, Acc: 0.2719, F1: 0.2353, MAE: 1.2399
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.71it/s]
2025-12-09 01:22:07,224 - INFO - Val   - Loss: 1.2890, Acc: 0.3314, F1: 0.2506, MAE: 1.0917
2025-12-09 01:22:07,698 - INFO -   -> New best model saved! (Val MAE: 1.0917)
2025-12-09 01:22:07,698 - INFO -
==================================================
2025-12-09 01:22:07,698 - INFO - Epoch 2/20
2025-12-09 01:22:07,698 - INFO - ==================================================
2025-12-09 01:22:07,698 - INFO - Ordinal weight: 0.23
Training: 100%|██████████| 340/340 [00:17<00:00, 19.09it/s, loss=0.611]
2025-12-09 01:22:25,510 - INFO - Train - Loss: 1.3148, Acc: 0.3670, F1: 0.3235, MAE: 0.9539
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.64it/s]
2025-12-09 01:22:26,570 - INFO - Val   - Loss: 1.2300, Acc: 0.3669, F1: 0.2824, MAE: 0.9083
2025-12-09 01:22:27,044 - INFO -   -> New best model saved! (Val MAE: 0.9083)
2025-12-09 01:22:27,044 - INFO -
==================================================
2025-12-09 01:22:27,044 - INFO - Epoch 3/20
2025-12-09 01:22:27,044 - INFO - ==================================================
2025-12-09 01:22:27,044 - INFO - Ordinal weight: 0.26
Training: 100%|██████████| 340/340 [00:17<00:00, 19.04it/s, loss=0.426]
2025-12-09 01:22:44,907 - INFO - Train - Loss: 1.1849, Acc: 0.4186, F1: 0.3840, MAE: 0.8423
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.44it/s]
2025-12-09 01:22:45,972 - INFO - Val   - Loss: 1.1374, Acc: 0.3905, F1: 0.3215, MAE: 0.8343
2025-12-09 01:22:46,438 - INFO -   -> New best model saved! (Val MAE: 0.8343)
2025-12-09 01:22:46,438 - INFO -
==================================================
2025-12-09 01:22:46,438 - INFO - Epoch 4/20
2025-12-09 01:22:46,438 - INFO - ==================================================
2025-12-09 01:22:46,438 - INFO - Ordinal weight: 0.29
Training: 100%|██████████| 340/340 [00:17<00:00, 18.99it/s, loss=1.34]
2025-12-09 01:23:04,349 - INFO - Train - Loss: 1.0423, Acc: 0.4668, F1: 0.4262, MAE: 0.7535
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.42it/s]
2025-12-09 01:23:05,415 - INFO - Val   - Loss: 1.2543, Acc: 0.4142, F1: 0.2952, MAE: 0.8669
2025-12-09 01:23:05,415 - INFO -
==================================================
2025-12-09 01:23:05,415 - INFO - Epoch 5/20
2025-12-09 01:23:05,415 - INFO - ==================================================
2025-12-09 01:23:05,415 - INFO - Ordinal weight: 0.33
Training: 100%|██████████| 340/340 [00:17<00:00, 18.93it/s, loss=0.677]
2025-12-09 01:23:23,377 - INFO - Train - Loss: 0.8777, Acc: 0.5243, F1: 0.5084, MAE: 0.6540
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.22it/s]
2025-12-09 01:23:24,448 - INFO - Val   - Loss: 1.1893, Acc: 0.4586, F1: 0.3578, MAE: 0.7308
2025-12-09 01:23:24,923 - INFO -   -> New best model saved! (Val MAE: 0.7308)
2025-12-09 01:23:24,923 - INFO -
==================================================
2025-12-09 01:23:24,923 - INFO - Epoch 6/20
2025-12-09 01:23:24,923 - INFO - ==================================================
2025-12-09 01:23:24,923 - INFO - Ordinal weight: 0.36
Training: 100%|██████████| 340/340 [00:18<00:00, 18.88it/s, loss=0.242]
2025-12-09 01:23:42,937 - INFO - Train - Loss: 0.7070, Acc: 0.5925, F1: 0.5846, MAE: 0.5391
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.21it/s]
2025-12-09 01:23:44,008 - INFO - Val   - Loss: 1.3793, Acc: 0.4556, F1: 0.3343, MAE: 0.7544
2025-12-09 01:23:44,008 - INFO -
==================================================
2025-12-09 01:23:44,008 - INFO - Epoch 7/20
2025-12-09 01:23:44,008 - INFO - ==================================================
2025-12-09 01:23:44,008 - INFO - Ordinal weight: 0.39
Training: 100%|██████████| 340/340 [00:18<00:00, 18.85it/s, loss=0.592]
2025-12-09 01:24:02,046 - INFO - Train - Loss: 0.5194, Acc: 0.6923, F1: 0.7029, MAE: 0.3891
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.17it/s]
2025-12-09 01:24:03,118 - INFO - Val   - Loss: 1.4743, Acc: 0.4615, F1: 0.3372, MAE: 0.7219
2025-12-09 01:24:03,595 - INFO -   -> New best model saved! (Val MAE: 0.7219)
2025-12-09 01:24:03,595 - INFO -
==================================================
2025-12-09 01:24:03,595 - INFO - Epoch 8/20
2025-12-09 01:24:03,595 - INFO - ==================================================
2025-12-09 01:24:03,595 - INFO - Ordinal weight: 0.42
Training: 100%|██████████| 340/340 [00:18<00:00, 18.83it/s, loss=0.106]
2025-12-09 01:24:21,654 - INFO - Train - Loss: 0.3905, Acc: 0.7598, F1: 0.7703, MAE: 0.2977
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.14it/s]
2025-12-09 01:24:22,727 - INFO - Val   - Loss: 1.5586, Acc: 0.4349, F1: 0.3386, MAE: 0.7574
2025-12-09 01:24:22,727 - INFO -
==================================================
2025-12-09 01:24:22,727 - INFO - Epoch 9/20
2025-12-09 01:24:22,727 - INFO - ==================================================
2025-12-09 01:24:22,727 - INFO - Ordinal weight: 0.45
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.287]
2025-12-09 01:24:40,795 - INFO - Train - Loss: 0.2792, Acc: 0.8257, F1: 0.8442, MAE: 0.2100
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.10it/s]
2025-12-09 01:24:41,869 - INFO - Val   - Loss: 1.5069, Acc: 0.4645, F1: 0.3650, MAE: 0.7130
2025-12-09 01:24:42,347 - INFO -   -> New best model saved! (Val MAE: 0.7130)
2025-12-09 01:24:42,347 - INFO -
==================================================
2025-12-09 01:24:42,347 - INFO - Epoch 10/20
2025-12-09 01:24:42,347 - INFO - ==================================================
2025-12-09 01:24:42,347 - INFO - Ordinal weight: 0.48
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.347]
2025-12-09 01:25:00,416 - INFO - Train - Loss: 0.1859, Acc: 0.8780, F1: 0.8936, MAE: 0.1441
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.12it/s]
2025-12-09 01:25:01,490 - INFO - Val   - Loss: 1.7969, Acc: 0.4852, F1: 0.3923, MAE: 0.6420
2025-12-09 01:25:01,967 - INFO -   -> New best model saved! (Val MAE: 0.6420)
2025-12-09 01:25:01,968 - INFO -
==================================================
2025-12-09 01:25:01,968 - INFO - Epoch 11/20
2025-12-09 01:25:01,968 - INFO - ==================================================
2025-12-09 01:25:01,968 - INFO - Ordinal weight: 0.52
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.0745]
2025-12-09 01:25:20,038 - INFO - Train - Loss: 0.1347, Acc: 0.9119, F1: 0.9243, MAE: 0.0984
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.07it/s]
2025-12-09 01:25:21,113 - INFO - Val   - Loss: 2.1001, Acc: 0.4379, F1: 0.3168, MAE: 0.7604
2025-12-09 01:25:21,113 - INFO -
==================================================
2025-12-09 01:25:21,113 - INFO - Epoch 12/20
2025-12-09 01:25:21,113 - INFO - ==================================================
2025-12-09 01:25:21,113 - INFO - Ordinal weight: 0.55
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.00308]
2025-12-09 01:25:39,183 - INFO - Train - Loss: 0.0890, Acc: 0.9422, F1: 0.9484, MAE: 0.0671
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.09it/s]
2025-12-09 01:25:40,258 - INFO - Val   - Loss: 2.1456, Acc: 0.4645, F1: 0.3554, MAE: 0.7012
2025-12-09 01:25:40,258 - INFO -
==================================================
2025-12-09 01:25:40,258 - INFO - Epoch 13/20
2025-12-09 01:25:40,258 - INFO - ==================================================
2025-12-09 01:25:40,258 - INFO - Ordinal weight: 0.58
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.0119]
2025-12-09 01:25:58,325 - INFO - Train - Loss: 0.0549, Acc: 0.9624, F1: 0.9671, MAE: 0.0442
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.10it/s]
2025-12-09 01:25:59,399 - INFO - Val   - Loss: 2.3468, Acc: 0.4349, F1: 0.3214, MAE: 0.7544
2025-12-09 01:25:59,399 - INFO -
==================================================
2025-12-09 01:25:59,399 - INFO - Epoch 14/20
2025-12-09 01:25:59,399 - INFO - ==================================================
2025-12-09 01:25:59,399 - INFO - Ordinal weight: 0.61
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.000671]
2025-12-09 01:26:17,468 - INFO - Train - Loss: 0.0399, Acc: 0.9768, F1: 0.9797, MAE: 0.0262
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.01it/s]
2025-12-09 01:26:18,544 - INFO - Val   - Loss: 2.3785, Acc: 0.4290, F1: 0.3131, MAE: 0.7426
2025-12-09 01:26:18,544 - INFO -
==================================================
2025-12-09 01:26:18,544 - INFO - Epoch 15/20
2025-12-09 01:26:18,544 - INFO - ==================================================
2025-12-09 01:26:18,544 - INFO - Ordinal weight: 0.64
Training: 100%|██████████| 340/340 [00:18<00:00, 18.82it/s, loss=0.382]
2025-12-09 01:26:36,617 - INFO - Train - Loss: 0.0305, Acc: 0.9790, F1: 0.9822, MAE: 0.0251
Evaluating: 100%|██████████| 43/43 [00:01<00:00, 40.06it/s]
2025-12-09 01:26:37,692 - INFO - Val   - Loss: 2.3575, Acc: 0.4497, F1: 0.3267, MAE: 0.7337
2025-12-09 01:26:37,692 - INFO -
Early stopping triggered at epoch 15
2025-12-09 01:26:37,692 - INFO -
============================================================
2025-12-09 01:26:37,692 - INFO - Final Evaluation on Test Set
2025-12-09 01:26:37,692 - INFO - ============================================================
Evaluating: 100%|██████████| 44/44 [00:01<00:00, 40.05it/s]
2025-12-09 01:26:38,908 - INFO - Test - Loss: 1.5195, Acc: 0.4638, F1: 0.3766, MAE: 0.7217, Kappa: 0.5083
2025-12-09 01:26:38,909 - INFO -
Training history saved to models/training_history.json
2025-12-09 01:26:38,909 - INFO - ============================================================
2025-12-09 01:26:38,909 - INFO - Training complete!
2025-12-09 01:26:38,909 - INFO - ============================================================

[run.sh] Step 4: Model Evaluation
------------------------------------------------------------
2025-12-09 01:26:41,200 - INFO - ============================================================
2025-12-09 01:26:41,200 - INFO - Model Evaluation
2025-12-09 01:26:41,200 - INFO - ============================================================
2025-12-09 01:26:41,268 - INFO - Using device: cuda
2025-12-09 01:26:41,268 - INFO -
Loading model from models/best_model.pth
2025-12-09 01:26:41,868 - INFO - Model config: {'model_name': 'SZTAKI-HLT/hubert-base-cc', 'num_labels': 5, 'max_length': 512}
2025-12-09 01:26:42,266 - INFO -
Loading test data...
2025-12-09 01:26:42,267 - INFO - Test set size: 345
2025-12-09 01:26:42,267 - INFO -
Running evaluation...
2025-12-09 01:26:43,462 - INFO -
============================================================
2025-12-09 01:26:43,462 - INFO - EVALUATION RESULTS
2025-12-09 01:26:43,462 - INFO - ============================================================
2025-12-09 01:26:43,462 - INFO -
Overall Metrics:
2025-12-09 01:26:43,462 - INFO -   Accuracy:          0.4638
2025-12-09 01:26:43,462 - INFO -   Macro F1:          0.3766
2025-12-09 01:26:43,462 - INFO -   Weighted F1:       0.4504
2025-12-09 01:26:43,462 - INFO -   MAE:               0.7217
2025-12-09 01:26:43,462 - INFO -   Cohen's Kappa (Q): 0.5083
2025-12-09 01:26:43,462 - INFO -
Per-Class Metrics:
2025-12-09 01:26:43,462 - INFO -   1-Very Hard:
2025-12-09 01:26:43,462 - INFO -     Precision: 0.2857
2025-12-09 01:26:43,462 - INFO -     Recall:    0.1053
2025-12-09 01:26:43,462 - INFO -     F1-score:  0.1538
2025-12-09 01:26:43,462 - INFO -     Support:   19.0
2025-12-09 01:26:43,462 - INFO -   2-Hard:
2025-12-09 01:26:43,462 - INFO -     Precision: 0.4000
2025-12-09 01:26:43,462 - INFO -     Recall:    0.3000
2025-12-09 01:26:43,462 - INFO -     F1-score:  0.3429
2025-12-09 01:26:43,462 - INFO -     Support:   40.0
2025-12-09 01:26:43,462 - INFO -   3-Moderate:
2025-12-09 01:26:43,462 - INFO -     Precision: 0.3400
2025-12-09 01:26:43,462 - INFO -     Recall:    0.2329
2025-12-09 01:26:43,462 - INFO -     F1-score:  0.2764
2025-12-09 01:26:43,462 - INFO -     Support:   73.0
2025-12-09 01:26:43,462 - INFO -   4-Easy:
2025-12-09 01:26:43,462 - INFO -     Precision: 0.4085
2025-12-09 01:26:43,462 - INFO -     Recall:    0.6505
2025-12-09 01:26:43,462 - INFO -     F1-score:  0.5019
2025-12-09 01:26:43,462 - INFO -     Support:   103.0
2025-12-09 01:26:43,462 - INFO -   5-Very Easy:
2025-12-09 01:26:43,462 - INFO -     Precision: 0.6596
2025-12-09 01:26:43,462 - INFO -     Recall:    0.5636
2025-12-09 01:26:43,462 - INFO -     F1-score:  0.6078
2025-12-09 01:26:43,462 - INFO -     Support:   110.0
2025-12-09 01:26:43,462 - INFO -
Confusion Matrix:
2025-12-09 01:26:43,462 - INFO -   Predicted →
2025-12-09 01:26:43,462 - INFO -   True ↓     1     2     3     4     5
2025-12-09 01:26:43,462 - INFO -        1      2     7     3     6     1
2025-12-09 01:26:43,462 - INFO -        2      2    12     8    17     1
2025-12-09 01:26:43,462 - INFO -        3      1     9    17    33    13
2025-12-09 01:26:43,462 - INFO -        4      2     1    16    67    17
2025-12-09 01:26:43,462 - INFO -        5      0     1     6    41    62
2025-12-09 01:26:43,462 - INFO -
Results saved to models/evaluation_results.json
2025-12-09 01:26:43,462 - INFO - ============================================================
2025-12-09 01:26:43,462 - INFO - Evaluation complete!
2025-12-09 01:26:43,462 - INFO - ============================================================

[run.sh] Step 5: Inference Examples
------------------------------------------------------------
2025-12-09 01:26:45,746 - INFO - ============================================================
2025-12-09 01:26:45,746 - INFO - Legal Text Decoder - Inference
2025-12-09 01:26:45,746 - INFO - ============================================================
2025-12-09 01:26:45,812 - INFO - Using device: cuda
2025-12-09 01:26:46,781 - INFO - Predictor initialized successfully
2025-12-09 01:26:46,781 - INFO -
Running predictions on example texts:

2025-12-09 01:26:46,781 - INFO - Text 1:
2025-12-09 01:26:46,781 - INFO -   "A szerződés létrejöttével a vevő vállalja, hogy a vételárat megfizeti."
2025-12-09 01:26:46,890 - INFO -   Prediction: 5 - Könnyen érthető (Easy to understand)
2025-12-09 01:26:46,890 - INFO -   Confidence: 95.45%
2025-12-09 01:26:46,890 - INFO -   All probabilities:
2025-12-09 01:26:46,890 - INFO -     Label 1: 0.00%
2025-12-09 01:26:46,890 - INFO -     Label 2: 0.00%
2025-12-09 01:26:46,890 - INFO -     Label 3: 0.01%
2025-12-09 01:26:46,890 - INFO -     Label 4: 4.54%
2025-12-09 01:26:46,890 - INFO -     Label 5: 95.45%
2025-12-09 01:26:46,890 - INFO -
2025-12-09 01:26:46,890 - INFO - Text 2:
2025-12-09 01:26:46,890 - INFO -   "Az üzletszabályzat módosítása esetén az e tárgyban közzétett hirdetmény tartalmazza a megváltoztatot..."
2025-12-09 01:26:46,897 - INFO -   Prediction: 5 - Könnyen érthető (Easy to understand)
2025-12-09 01:26:46,897 - INFO -   Confidence: 97.27%
2025-12-09 01:26:46,897 - INFO -   All probabilities:
2025-12-09 01:26:46,897 - INFO -     Label 1: 0.00%
2025-12-09 01:26:46,897 - INFO -     Label 2: 0.00%
2025-12-09 01:26:46,897 - INFO -     Label 3: 0.00%
2025-12-09 01:26:46,897 - INFO -     Label 4: 2.73%
2025-12-09 01:26:46,897 - INFO -     Label 5: 97.27%
2025-12-09 01:26:46,897 - INFO -
2025-12-09 01:26:46,897 - INFO - Text 3:
2025-12-09 01:26:46,897 - INFO -   "A Vtv. 69. § 25. pontja alapján a vasúti társaság Üzletszabályzatának jóváhagyása a Vtv. szerinti va..."
2025-12-09 01:26:46,903 - INFO -   Prediction: 1 - Nagyon nehezen érthető (Very hard to understand)
2025-12-09 01:26:46,903 - INFO -   Confidence: 99.95%
2025-12-09 01:26:46,903 - INFO -   All probabilities:
2025-12-09 01:26:46,903 - INFO -     Label 1: 99.95%
2025-12-09 01:26:46,903 - INFO -     Label 2: 0.02%
2025-12-09 01:26:46,903 - INFO -     Label 3: 0.02%
2025-12-09 01:26:46,903 - INFO -     Label 4: 0.00%
2025-12-09 01:26:46,903 - INFO -     Label 5: 0.00%
2025-12-09 01:26:46,903 - INFO -
2025-12-09 01:26:46,903 - INFO - ============================================================
2025-12-09 01:26:46,903 - INFO - Inference complete!
2025-12-09 01:26:46,903 - INFO - ============================================================

============================================================
[run.sh] Pipeline finished at 2025-12-09T01:26:47+01:00
============================================================
